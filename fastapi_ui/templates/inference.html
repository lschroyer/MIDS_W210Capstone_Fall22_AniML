{% extends "base.html" %}
{% set active_page = "inference" %}

{% block title %}Inference{% endblock %}

{% block head %}
{{ super() }}


{% endblock %}


{% block page_content %}
<h1 class="cap">Automatic Image Detection</h1>

    <p>No more combing through thousands of false triggers! <br>
    Simply add all your images below or a zip file of your images and weâ€™ll cluster them into similar groups based on likeness.
    <br>
    <br>
</p>

<!-- <script type="text/javascript">
    function previewFile() {
        console.log("document:")
        console.log(document)
        var inputs = document.querySelectorAll('input[type=file]');
        console.log("inputs:")
        console.log(inputs)
        var inputs_array = [...inputs];
        var file_list = inputs[0].files
        console.log(file_list)
        console.log(inputs_array)
        for(let i=0; i<file_list.length; i++){
            // let file = inputs[i].files[0];
            let file = file_list[i];
            console.log("filename:")
            console.log(file)
            //use file
            const reader = new FileReader();
            reader.addEventListener("load", function() {
                uploadFile(file)
            }, false);
            if (file) {
                reader.readAsDataURL(file);
            }
        }
    }

    function uploadFile(file) {
        var formData = new FormData();
        formData.append('file', file);
        fetch('/upload', {
                method: 'POST',
                body: formData,
            })
            .then(response => {
                console.log(response);
            })
            .catch(error => {
                console.error(error);
            });
    }
</script>
<form action="/action_page.php">
  <input type="file" id="files"
         name="files[]" multiple
         onchange="previewFile()"
         accept="image/*, zip,application/octet-stream,application/zip,application/x-zip,application/x-zip-compressed"><br><br>
  <label id="files-upload-label" for="files"><i previewFile()></i></label>

</form> -->

<html>

<head>
    <title>AniML Detect with YOLOv5</title>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- <script src="{{ url_for('static', path='app.js') }}"></script> -->
    <script src="../static/js/app.js"></script>
    <!-- <link href="{{ url_for('static', path='css/styles.css') }}" rel="stylesheet"> -->
    <link rel="stylesheet" href="../static/css/styles.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
        crossorigin="anonymous">
</head>

<body>
    <h2> AniML - Object Detection</h2>
    <p style="text-align: center;">Upload images and perform YOLOv5 object detection</p>
    <div class="container">
        <div class="col-sm-12">
            <div class="form-row">
                <div class="form-group col-md-8">
                    <label for="file" id="label_file">&nbsp;</label>
                    <input class="form-control" type="file" id="input_file" multiple />
                </div>
                <div class="form-group col-md-4">
                    <label>&nbsp;</label>
                    <button type="button" class="btn btn-primary btn-block" id="btn-process">Upload and Process</button>
                </div>
            </div>
            <div class="form-row" id="row_results">
                <div class="col-md-12">
                    <div class="form-row" style="margin-top: 10px;">
                        <div class="col-md-12">
                            <table border="1px solid" id="table_result">
                                <thead>
                                    <th>Task Id</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="form-row" id="row_detail">
                    <div class="col-md-3"><textarea id="result_txt" style="height: 800px; font-size: 12px;"></textarea></div>
                    <div class="col-md-9"><a id="result_link"><img id="result_img" width="600px" /></a></div>
                </div>

            </div>
        </div>
</body>

</html>


{% endblock %}

{% block scripts %}
{{ super() }}


{% endblock %}